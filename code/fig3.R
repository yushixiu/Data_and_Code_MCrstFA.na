load(paste(WD.PATH, 'data/automobile.RData', sep=''))
#BIC
colors=c('dimgray','dodgerblue','darksalmon','mediumpurple','mediumseagreen')
postscript(paste(WD.PATH, 'results/BIC_plot.eps', sep=''),width = 800,height = 800)
par(mfrow=c(1,3),pty='s',cex.lab=1.5,cex.main=3)
#MCFA
plot(bic_n[1,], xlab = 'Number of factors', ylab = 'BIC', main='MCFA', pch=0,cex=1.2,lwd=2,col=colors[1],type='o',lty=1,ylim=c(4000,6700),cex.main = 2)
lines(bic_n[2,],pch=1,cex=1.2,lwd=2,col=colors[2],type='o',lty=2)
lines(bic_n[3,],data$y2,pch=2,cex=1.2,lwd=2,col=colors[3],type='o',lty=3)
lines(bic_n[4,],data$y3,pch=4,cex=1.2,lwd=2,col=colors[4],type='o',lty=4)
lines(bic_n[5,],data$y3,pch=5,cex=1.2,lwd=2,col=colors[5],type='o',lty=5)
legend('topright', legend = c('g=1','g=2','g=3','g=4','g=5'),
       col = colors, lty = c(1,2,3,4,5), pch=c(0,1,2,4,5),lwd=2, cex = 1.3, seg.len=1.3,text.width=0.5, bty='n')
points(x=7, y=4354.691, lwd=2, cex=4, col='red')
grid(lty= 1)
text(5.7,4300,bquote('4354.691'),col='red', cex=1.5)
abline(h = 4200, col = 'lightgray')
#MCtFA
plot(bic_t[1,], xlab = 'Number of factors', ylab = 'BIC', main='MCtFA', pch=0,cex=1.2,lwd=2,col=colors[1],type='o',lty=1,ylim=c(4000,6700),cex.main = 2)
lines(bic_t[2,],pch=1,cex=1.2,lwd=2,col=colors[2],type='o',lty=2)
lines(bic_t[3,],data$y2,pch=2,cex=1.2,lwd=2,col=colors[3],type='o',lty=3)
lines(bic_t[4,],data$y3,pch=4,cex=1.2,lwd=2,col=colors[4],type='o',lty=4)
lines(bic_t[5,],data$y3,pch=5,cex=1.2,lwd=2,col=colors[5],type='o',lty=5)
legend('topright', legend = c('g=1','g=2','g=3','g=4','g=5'),
       col = colors, lty = c(1,2,3,4,5), pch=c(0,1,2,4,5), lwd=2, cex = 1.3, seg.len=1.3,text.width=0.5, bty='n')
points(x=6, y=4250, lwd=2, cex=4, col='red')
grid(lty= 1)
text(4.7,4200,bquote('4240.859'),col='red', cex=1.5)
abline(h = 4200, col = 'lightgray')
#MCrstFA
plot(bic_rst[1,], xlab = 'Number of factors', ylab = 'BIC', main='MCrstFA', pch=0,cex=1.2,lwd=2,col=colors[1],type='o',lty=1,ylim=c(4000,6700),cex.main = 2)
lines(bic_rst[2,],pch=1,cex=1.2,lwd=2,col=colors[2],type='o',lty=2)
lines(bic_rst[3,],data$y2,pch=2,cex=1.2,lwd=2,col=colors[3],type='o',lty=3)
lines(bic_rst[4,],data$y3,pch=4,cex=1.2,lwd=2,col=colors[4],type='o',lty=4)
lines(bic_rst[5,],data$y3,pch=5,cex=1.2,lwd=2,col=colors[5],type='o',lty=5)
legend('topright', legend = c('g=1','g=2','g=3','g=4','g=5'),
       col = colors, lty = c(1,2,3,4,5), pch=c(0,1,2,4,5),lwd=2, cex = 1.3, seg.len=1.3,text.width=0.5, bty='n')
points(x=6, y=4050, lwd=2, cex=4, col='red')
grid(lty= 1)
text(4.7,3990,bquote(bold('4154.076')),col='red', cex=1.5)
abline(h = 4200, col = 'lightgray')
title('(a) BIC', line = -12,outer = T)
dev.off()

#ICL
postscript(paste(WD.PATH, 'results/ICL_plot.eps', sep=''),width = 800,height = 800)
par(mfrow=c(1,3),pty='s',cex.lab=1.5,cex.main=3)
#MCFA
plot(icl_n[1,], xlab = 'Number of factors', ylab = 'ICL', main='MCFA', pch=0,cex=1.2,lwd=2,col=colors[1],type='o',lty=1,ylim=c(4000,6900),cex.main = 2)
lines(icl_n[2,],pch=1,cex=1.2,lwd=2,col=colors[2],type='o',lty=2)
lines(icl_n[3,],data$y2,pch=2,cex=1.2,lwd=2,col=colors[3],type='o',lty=3)
lines(icl_n[4,],data$y3,pch=4,cex=1.2,lwd=2,col=colors[4],type='o',lty=4)
lines(icl_n[5,],data$y3,pch=5,cex=1.2,lwd=2,col=colors[5],type='o',lty=5)
legend('topright', legend = c('g=1','g=2','g=3','g=4','g=5'),
       col = colors, lty = c(1,2,3,4,5), pch=c(0,1,2,4,5),lwd=2, cex = 1.3, seg.len=1.3,text.width=0.5, bty='n')
points(x=7, y=4356.013, lwd=2, cex=4, col='red')
grid(lty= 1)
text(5.8,4300,bquote('4356.013'),col='red', cex=1.5)
abline(h = 4200, col = 'lightgray')
#MCtFA
plot(icl_t[1,], xlab = 'Number of factors', ylab = 'ICL', main='MCtFA', pch=0,cex=1.2,lwd=2,col=colors[1],type='o',lty=1,ylim=c(4000,6900),cex.main = 2)
lines(icl_t[2,],pch=1,cex=1.2,lwd=2,col=colors[2],type='o',lty=2)
lines(icl_t[3,],data$y2,pch=2,cex=1.2,lwd=2,col=colors[3],type='o',lty=3)
lines(icl_t[4,],data$y3,pch=4,cex=1.2,lwd=2,col=colors[4],type='o',lty=4)
lines(icl_t[5,],data$y3,pch=5,cex=1.2,lwd=2,col=colors[5],type='o',lty=5)
legend('topright', legend = c('g=1','g=2','g=3','g=4','g=5'),
       col = colors, lty = c(1,2,3,4,5), pch=c(0,1,2,4,5), lwd=2, cex = 1.3, seg.len=1.3,text.width=0.5, bty='n')
points(x=6, y=4260, lwd=2, cex=4, col='red')
grid(lty= 1)
text(4.7,4200,bquote('4245.811'),col='red', cex=1.5)
abline(h = 4200, col = 'lightgray')
#MCrstFA
plot(icl_rst[1,], xlab = 'Number of factors', ylab = 'ICL', main='MCrstFA', pch=0,cex=1.2,lwd=2,col=colors[1],type='o',lty=1,ylim=c(4000,6900),cex.main = 2)
lines(icl_rst[2,],pch=1,cex=1.2,lwd=2,col=colors[2],type='o',lty=2)
lines(icl_rst[3,],data$y2,pch=2,cex=1.2,lwd=2,col=colors[3],type='o',lty=3)
lines(icl_rst[4,],data$y3,pch=4,cex=1.2,lwd=2,col=colors[4],type='o',lty=4)
lines(icl_rst[5,],data$y3,pch=5,cex=1.2,lwd=2,col=colors[5],type='o',lty=5)
legend('topright', legend = c('g=1','g=2','g=3','g=4','g=5'),
       col = colors, lty = c(1,2,3,4,5), pch=c(0,1,2,4,5),lwd=2, cex = 1.3, seg.len=1.3,text.width=0.5, bty='n')
points(x=6, y=4060, lwd=2, cex=4, col='red')
grid(lty= 1)
text(4.7,3990,bquote(bold('4155.521')),col='red', cex=1.5)
title('(b) ICL', line = -12,outer = T)
abline(h = 4200, col = 'lightgray')
dev.off()
